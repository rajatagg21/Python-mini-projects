import pandas as pd

def batch_iterator(df: pd.DataFrame, batch_size: int = 1000):
    for start in range(0, len(df), batch_size):
        yield df.iloc[start:start + batch_size]

# Usage
for batch_df in batch_iterator(df):
    # process batch_df
    print(batch_df.shape)
